# パターン抽出の例

チャット履歴からタスクパターンを抽出・分類するための実践的ガイド。

---

## WHAT / HOW の分離

プロンプトから「何をするか（目的）」と「どうするか（方法）」を分離する。
同じ HOW が複数の WHAT で再現されることがある。

### 例1: コミット系タスク

| プロンプト | WHAT | HOW |
|---|---|---|
| 「変更をわかりやすいメッセージでコミットして」 | 変更をコミットする | — |
| 「変更を意味のある単位でコミットして」 | 変更をコミットする | 適切な粒度に分割する |
| 「差分を確認してからコミットして」 | 変更をコミットする | 事前に差分確認する |

3セッション以上同じ HOW（適切な粒度でコミット）が出現 → スキル候補。

### 例2: 品質チェック系タスク

| プロンプト | WHAT | HOW |
|---|---|---|
| 「修正したら typecheck と lint 通してコミット」 | コード修正 + コミット | typecheck → lint → commit の順 |
| 「エラー直したら型チェックして」 | バグ修正 | typecheck を通す |
| 「コミット前に lint 忘れないで」 | コミット | lint を事前実行 |

繰り返しの HOW（typecheck/lint → commit）→ `pre-commit-checker` スキル候補。

---

## FLOW パターン（セッション間の手順列）

単一タスクではなく、複数セッションで繰り返される一連の手順を認識する。

### 例: UI/UX 改善フロー

以下のプロンプト列が 4 セッションで観察された:

```
1. 「このページの UI/UX 改善点を洗い出して」
2. 「全部まとめて対応して」
3. 「ここのボタンの色だけ変えて」
4. 「変更をコミットして」
```

→ FLOW パターン「UI改善点洗い出し → 一括対応 → 微調整 → コミット」として検出。

---

## 粒度の判断基準

適切な粒度 = 同じ手順・判断基準で処理できるセッション群。

**良い粒度（スキル化に適する）:**
- 「レビュー指摘を修正して typecheck/lint を通してコミット」
  - 毎回同じ手順で処理できる

**粒度が粗すぎる（スキル化に不適）:**
- 「UI/UX の改善」
  - 内部に「洗い出し」「一括対応」「微調整」など異なる手順が混在

**判断できない場合**: 異なる手順を含むなら分割。同じ手順で一括処理できるなら統合。

---

## 既存スキルとの重複確認

パターンが検出されたら `<SKILLS_BASE>/`（`~/.copilot/skills` または `<workspace-skill-dir>`）を確認し、既存スキルと比較する:

```bash
ls <SKILLS_BASE>/
# 例: react-frontend-unit-tester, systematic-debugging, ...
```

重複する場合:
- 完全重複 → 候補から除外
- 部分重複 → 既存スキルの改善として提示

---

## クロスワークスペース分析の例

複数のワークスペースを横断して同じ HOW が出現:

- ワークスペース A: 「変更を適切な粒度でコミットして」× 3回
- ワークスペース B: 「コミット前に内容をまとめて」× 2回
- ワークスペース C: 「差分確認してからコミット」× 3回

→ 3ワークスペースで同じ HOW → グローバルなコミットスキル候補として提案。
