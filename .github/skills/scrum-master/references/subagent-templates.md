# サブエージェントへの指示テンプレート

## 目次

- [重要な注意事項](#重要な注意事項)
- [requirements-definer 呼び出し時](#requirements-definer-呼び出し時)
- [skill: null タスク実行時](#skill-null-タスク実行時)
- [スキル実行時](#スキル実行時)
- [スキル作成時](#スキル作成時)
- [スキル改良時](#スキル改良時)
- [コードベースからスキル生成時](#コードベースからスキル生成時)
- [スキル招募時](#スキル招募時)
- [スプリントレビュー時](#スプリントレビュー時)
- [スキル昇格時](#スキル昇格時)
- [スキル評価時](#スキル評価時)
- [スキル共有時](#スキル共有時)
- [スキル発見時](#スキル発見時)

## 重要な注意事項

- SKILL.md の内容をプロンプトに埋め込まない。ファイルパスだけ渡し、サブエージェント自身に読ませる。これによりプロンプトを短く保ち、安定性を確保する。
- すべてのテンプレートに戻り値の形式指定を含める。これによりscrum-masterが結果を確実にパースできる。

## requirements-definer 呼び出し時

```
requirements-definer スキルでユーザーと対話して要件を定義する。

手順: まず .github/skills/requirements-definer/SKILL.md を読んで手順に従ってください。
ユーザーのプロンプト: [元のプロンプト]
出力先: requirements.json（作業ディレクトリのルート）
出力スキーマ: .github/skills/requirements-definer/references/requirements-schema.md を参照すること。

完了後、requirements.json を出力して終了してください。計画立案やタスク分解は行わないこと。

結果を以下の形式で返してください:
ステータス: 成功 / 失敗
goal: [requirements.json の goal フィールドの値]
要件数: 機能要件 [N] 件 / 非機能要件 [M] 件
サマリー: [1〜2文で結果を説明]
```

**scrum-master の次の処理**: サブエージェント完了後、`requirements.json` を読み込んでバックログを作成する（Phase 2）。

## skill: null タスク実行時

スキル不要な調査・判断・軽微な編集のテンプレート。

```
以下のタスクを実行してください。

タスク: [action]
コンテキスト: [先行タスクのresultを1〜2行で要約]
完了基準: [done_criteria]

結果を以下の形式で返してください:
ステータス: 成功 / 失敗
サマリー: [1〜2文で結果を説明]
```

## スキル実行時

```
[skill-name] スキルを実行する。

手順: まず [skill-md-path] を読んで手順に従ってください。
タスク: [action]
コンテキスト: [先行タスクのresultを1〜2行で要約]
完了基準: [done_criteria]
フィードバック: 実行後フィードバック節はスキップしてください。フィードバックはスプリント終了時に一括で収集されます。

結果を以下の形式で返してください:
ステータス: 成功 / 失敗
サマリー: [1〜2文で結果を説明]
```

## スキル作成時

```
skill-creator スキルで新しいスキルを作成する。

手順: まず .github/skills/skill-creator/SKILL.md を読んで手順に従ってください。
作成するスキル: [概要]
配置先: .github/skills/
ユーザーに要件を確認しながら進めること。

結果を以下の形式で返してください:
ステータス: 成功 / 失敗
作成されたスキル名: [name]
サマリー: [1〜2文で結果を説明]
```

## スキル改良時

```
skill-creator スキルで既存スキルを改良する。

手順: まず .github/skills/skill-creator/SKILL.md を読んで手順に従ってください。
対象スキル: [skill-md-path]
改良内容: [改善点・追加機能・分割方針の説明]
配置先: .github/skills/
分割する場合は、元スキルの機能が漏れなく引き継がれることを確認すること。
ユーザーに改良方針を確認しながら進めること。

結果を以下の形式で返してください:
ステータス: 成功 / 失敗
変更されたスキル名: [name(s)]
サマリー: [1〜2文で結果を説明]
```

## コードベースからスキル生成時

```
codebase-to-skill スキルで既存コードベースからスキルを生成する。

手順: まず .github/skills/codebase-to-skill/SKILL.md を読んで手順に従ってください。
対象コードベース: [codebase-path]
生成するスキルの用途: [タスクのactionと不足しているスキルの概要]
配置先: .github/skills/
既存スキルの改良の場合: [既存スキルのパスと不足点。新規作成の場合は「なし」]
ユーザーにスコープとフォーカスを確認しながら進めること。

結果を以下の形式で返してください:
ステータス: 成功 / 失敗
作成されたスキル名: [name]
サマリー: [1〜2文で結果を説明]
```

## スキル招募時

```
skill-recruiter スキルで外部リポジトリからスキルを取得・検証する。

手順: まず .github/skills/skill-recruiter/SKILL.md を読んで手順に従ってください。
取得するスキルのURL: [url]
用途: [タスクのactionと不足しているスキルの概要]

結果を以下の形式で返してください:
ステータス: 成功 / 失敗
取得されたスキル名: [name]
サマリー: [1〜2文で結果を説明]
```

## スプリントレビュー時

```
sprint-reviewer スキルでスプリントのレビューとレトロスペクティブを実施する。

手順: まず .github/skills/sprint-reviewer/SKILL.md を読んで手順に従ってください。
ゴール: [goal]
スプリント番号: [N]
スプリント計画:
- [計画時に選択したタスクと優先度の要約]
実行ログサマリー:
- [予定どおり進んだ点 / 遅延・失敗が出た点]
タスク一覧:
- [task-id]: action=[action], done_criteria=[done_criteria], status=[status], result=[result]
- ...

結果を以下の形式で返してください:
レビュー: [ゴール進捗の評価 1〜2文]
進め方レビュー: [スプリントプランと実行プロセスの評価 1〜2文]
レトロスペクティブ: [改善点 1〜2文]
次スプリント反映アクション:
- [改善アクション1]
- [改善アクション2]
ブロッカー: [あれば列挙、なければ「なし」]
```

## スキル昇格時

```
git-skill-manager スキルでワークスペーススキルをユーザー領域に昇格する。

手順: まず .github/skills/git-skill-manager/SKILL.md を読んで promote 操作の手順に従ってください。
対象スキル: [skill-name]
操作: promote
補足: .github/skills/[skill-name]/ を ~/.copilot/skills/ にコピーし、
      書き込み可能なリポジトリがあれば push も提案してください。

結果を以下の形式で返してください:
ステータス: 成功 / 失敗
昇格先: [~/.copilot/skills/<name>]
push先: [repo-name または「なし」]
サマリー: [1〜2文で結果を説明]
```

## スキル評価時

```
skill-evaluator スキルでワークスペーススキルを評価する。

手順: まず .github/skills/skill-evaluator/SKILL.md を読んで手順に従ってください。
操作: 全ワークスペーススキルを評価して昇格・改良・試用継続を判断する。
補足: 評価結果をユーザーに提示し、昇格 / 改良 / 継続 のアクションを確認してください。
      昇格 → git-skill-manager promote、改良 → git-skill-manager refine を実行してください。

結果を以下の形式で返してください:
ステータス: 成功 / 失敗
昇格したスキル: [name1, name2, ...（なければ「なし」）]
改良を開始したスキル: [name1, name2, ...（なければ「なし」）]
サマリー: [1〜2文で結果を説明]
```

## スキル共有時

```
git-skill-manager スキルでスキルをリポジトリに共有する。

手順: まず .github/skills/git-skill-manager/SKILL.md を読んで手順に従ってください。
対象スキル: [skill-path]
操作: push
リポジトリ: [repo-name]

結果を以下の形式で返してください:
ステータス: 成功 / 失敗
サマリー: [1〜2文で結果を説明]
```

## スキル発見時

```
git-skill-manager スキルの discover 操作で、チャット履歴から新しいスキル候補を発見する。

手順: まず .github/skills/git-skill-manager/SKILL.md を読んで discover 操作の手順に従ってください。
操作: discover
補足: ユーザーのチャット履歴を分析し、繰り返しワークフローをスキル候補として提案してください。
      候補が見つかれば、ユーザーに選択させてから skill-creator でスキルを生成してください。

結果を以下の形式で返してください:
ステータス: 成功 / 失敗
発見されたスキル候補数: [N 件]
生成されたスキル: [name1, name2, ...（なければ「なし」）]
サマリー: [1〜2文で結果を説明]
```
